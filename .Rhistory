library(pwr)
power = pwr.t.test(n = 30, d = 1, type = ('two.sample'), alternative = 'greater')
install.packages(topicmodels)
install.packages("topicmodels")
123/10.7
10.7 * 11
123 - 117.7
library(languageserver)
install.packages('vscDebugger')
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
library(tidyverse)
date = read_csv('date_SA.csv')
View(date)
pub = read_csv('pub_SA.csv')
View(pub)
text = read_csv('text_SA.csv')
title = read_csv('title_SA.csv')
doom_df = bind_cols(date, pub, title, text)
View(title)
View(text)
rm(list = ls())
date = read_csv('date_SA.csv')
pub = read_csv('pub_SA.csv')
text = read_csv('text_SA.csv')
title = read_csv('title_SA.csv')
ac_title = read_csv('actual_title.csv')
doom_df = bind_cols(date, pub, ac_title, title, text)
save(doom_df, file = 'doomsday.RData')
View(doom_df)
View(date)
date = read_csv('date_SA.csv', col_names = c('Index', 'Date'))
View(date)
date = read_csv('date_SA.csv', col_names = c('Index', 'Date'), skip = 1)
View(date)
pub = read_csv('pub_SA.csv', col_names = c('Index', 'Publication'), skip = 1)
text = read_csv('text_SA.csv') %>% rename_with(~ paste0('FT_', .x))
View(text)
text = read_csv('text_SA.csv') %>% rename_with(~ paste0('FT_', .x)) %>% rename(Index = FT...1 )
View(text)
text = read_csv('text_SA.csv') %>% rename_with(~ paste0('FT_', .x)) %>% rename(Index = FT_...1 )
View(text)
title = read_csv('title_SA.csv') %>% rename_with(~ paste0('Title_', .x)) %>% rename(Index = Title_...1)
ac_title = read_csv('actual_title.csv', col_names = c('Index', 'Publication'), skip = 1)
View(ac_title)
doom_df = bind_cols(date$Date, pub, ac_title, title, text)
doom_df = bind_cols(date$Date, pub$Publication, ac_title$Publication, title[-c('Index')], text)
text = read_csv('text_SA.csv') %>% rename_with(~ paste0('FT_', .x)) %>% select(-c(FT_...1))
View(text)
title = read_csv('title_SA.csv') %>% rename_with(~ paste0('Title_', .x)) %>% select(-c(Title_...1))
doom_df = bind_cols(date$Date, pub$Publication, ac_title$Publication, title, text)
View(doom_df)
View(doom_df)
doom_df = bind_cols(date$Date, pub$Publication, ac_title$Publication, title, text) %>%
rename(c(Date = ...1, Publication = ...2, Title = ...3))
doom_df = bind_cols(date$Date, pub$Publication, ac_title$Publication, title, text) %>%
rename(c(Date = ...1, Publication = ...2, Title = ...3)) %>%
distinct(Title, .keep_all = T)
doom_df = bind_cols(date$Date, pub$Publication, ac_title$Publication, title, text) %>%
rename(c(Date = ...1, Publication = ...2, Title = ...3))
doom_df = bind_cols(date$Date, pub$Publication, ac_title$Publication, title, text) %>%
rename(c(Date = ...1, Publication = ...2, Title = ...3)) %>%
distinct(Title, .keep_all = T)
save(doom_df, file = 'doomsday.RData')
x = colSums(doom_df[4:13])
x = colSums(doom_df[4:13], na.rm = T)
hist(x, plot = T)
print(x)
y = colSums(doom_df[14:23], na.rm = T)
print(y)
z = sum(y)
library(tidyverse)
library(readr)
burnet <- read_csv("burnet.csv")
View(burnet)
burnet = read_csv('burnet.csv') %>% rename(Burnet = 0)
View(burnet)
burnet = read_csv('burnet.csv') %>% rename("Burnet" = "0")
View(burnet)
doherty = read_csv('doherty.csv') %>% rename("Doherty"="0")
View(doherty)
doom_df = bind_cols(date$Date, pub$Publication, ac_title$Publication, title, text, burnet$Burnet, doherty$Doherty) %>%
rename(c(Date = ...1, Publication = ...2, Title = ...3, Burnet = ...4, Doherty = ...5)) %>%
distinct(Title, .keep_all = T)
date = read_csv('date_SA.csv', col_names = c('Index', 'Date'), skip = 1)
pub = read_csv('pub_SA.csv', col_names = c('Index', 'Publication'), skip = 1)
text = read_csv('text_SA.csv') %>% rename_with(~ paste0('FT_', .x)) %>% select(-c(FT_...1))
title = read_csv('title_SA.csv') %>% rename_with(~ paste0('Title_', .x)) %>% select(-c(Title_...1))
ac_title = read_csv('actual_title.csv', col_names = c('Index', 'Publication'), skip = 1)
doom_df = bind_cols(date$Date, pub$Publication, ac_title$Publication, title, text, burnet$Burnet, doherty$Doherty) %>%
rename(c(Date = ...1, Publication = ...2, Title = ...3, Burnet = ...4, Doherty = ...5)) %>%
distinct(Title, .keep_all = T)
doom_df = bind_cols(date$Date, pub$Publication, ac_title$Publication, title, text, burnet$Burnet, doherty$Doherty) %>%
rename(c(Date = ...1, Publication = ...2, Title = ...3)) %>%
distinct(Title, .keep_all = T)
View(doom_df)
doom_df = bind_cols(date$Date, pub$Publication, ac_title$Publication, title, text, burnet$Burnet, doherty$Doherty) %>%
rename(c(Date = ...1, Publication = ...2, Title = ...3, Burnet = ...24, Doherty = ...25)) %>%
distinct(Title, .keep_all = T)
View(doom_df)
save(doom_df, file = 'doomsday.RData')
doom_df$Burnet <- ifelse(doom_df$Burnet == 'Burnet', 1, 0)
is.na(doom_df$Burnet) <- 0
View(doom_df)
doom_df$Burnet[is.na(doom_df$Burnet)] <- 0
table(doom_df$Burnet)
doom_df$Doherty <- ifelse(doom_df$Doherty == 'Doherty', 1, 0)
doom_df$Doherty[is.na(doom_df$Doherty)] <- 0
save(doom_df, file = 'doomsday.RData')
table(doom_df$Burnet, doom_df$Doherty)
blakely = read_csv('blakely.csv')
View(blakely)
doom_df = bind_cols(date$Date, pub$Publication, ac_title$Publication, title, text, burnet$Burnet,
doherty$Doherty, blakely$`0`) %>%
rename(c(Date = ...1, Publication = ...2, Title = ...3, Burnet = ...24, Doherty = ...25)) %>%
distinct(Title, .keep_all = T)
View(doom_df)
doom_df = bind_cols(date$Date, pub$Publication, ac_title$Publication, title, text, burnet$Burnet,
doherty$Doherty, blakely$`0`) %>%
rename(c(Date = ...1, Publication = ...2, Title = ...3, Burnet = ...24,
Doherty = ...25, Blake_Thom = ...26)) %>%
distinct(Title, .keep_all = T)
doom_df$Blake_Thom <- ifelse(is.na(doom_df$Blake_Thom), 0, 1)
table(doom_df$Blake_Thom)
save(doom_df, file = 'doomsday.RData')
x = colSums(doom_df[,c(4:13)])
x
x = colSums(doom_df[,c(4:13)], na.rm = T)
x
titledf = doom_df[1:13]
titledf$TextTitle <- 'Title'
textdf = doom_df[1:3,14:26]
textdf$TextTitle <- 'Text'
titledf %>% rename_with(.fn = gsub('Title_', ""))
names(titledf) <- sub('^Title_', '', names(titledf))
View(titledf)
names(textdf) <- sub('^FT_', '', names(textdf))
textdf = doom_df[1:3,14:26]
View(textdf)
textdf = doom_df[,c(1:3,14:26)]
textdf$TextTitle <- 'Text'
names(textdf) <- sub('^FT_', '', names(textdf))
long_doom <- full_join(titledf, textdf,
by = c('Date', 'Publication', 'Title'))
long_doom <- full_join(titledf, textdf,
by = c('TextTitle'))
View(long_doom)
long_doom <- bind_rows(titledf, textdf)
View(long_doom)
save(long_doom, file='longform doom.csv')
an = glm(fear ~ TextTitle, family=binomial)
an = glm(fear ~ TextTitle, family=binomial, data = long_doom)
table(long_doom$fear)
long_doom$total = long_doom$positive - long_doom$negative
an = lm(total ~ TextTitle, data = long_doom)
summary(an)
x = long_doom %>% filter(TextTitle == "Title") %>%
mean(total)
x = long_doom %>% filter(TextTitle == "Title")
y = mean(x$total)
long_doom[is.na(long_doom)] <- 0
doom_df$Doherty <- ifelse(is.na(doom_df$Doherty), 0, 1)
doom_df$Burnet <- ifelse(is.na(doom_df$Burnet), 0, 1)
save(doom_df, file = 'doomsday.RData')
table(doom_df$Burnet, doom_df$Doherty)
titledf = doom_df[1:13]
titledf$TextTitle <- 'Title'
names(titledf) <- sub('^Title_', '', names(titledf))
textdf = doom_df[,c(1:3,14:26)]
textdf$TextTitle <- 'Text'
names(textdf) <- sub('^FT_', '', names(textdf))
long_doom <- bind_rows(titledf, textdf)
save(long_doom, file='longform doom.csv')
long_doom$total = long_doom$positive - long_doom$negative
an = lm(total ~ TextTitle, data = long_doom)
summary(an)
x = long_doom %>% filter(TextTitle == "Title")
y = mean(x$total)
View(long_doom)
long_doom[is.na(long_doom)] <- 0
long_doom$total = long_doom$positive - long_doom$negative
an = lm(total ~ TextTitle, data = long_doom)
summary(an)
x = long_doom %>% filter(TextTitle == "Title")
y = mean(x$total)
t = long_doom %>% filter(TextTitle == 'Text')
u = mean(t$total)
ggplot(data = long_doom)+
geom_histogram(x = total)
ggplot(data = long_doom)+
geom_histogram(aes(x = total))
check = long_doom %>% filter(total > 75)
View(check)
test = long_doom[long_doom$total < 50]
test = long_doom %>% filter(total < 50)
an = lm(total ~ TextTitle, data = test)
summary(an)
titledf$total <- titledf$positive - titledf$negative
library(scales)
titledf$scotal <- rescale(titledf$total, to = c(0,10))
textdf$total <- textdf$positive - textdf$negative
textdf$scotal <- rescale(textdf$total, to = c(0,10))
long_doom <- bind_rows(titledf, textdf)
save(long_doom, file='longform doom.csv')
long_doom[is.na(long_doom)] <- 0
doom_df[is.na(doom_df)] <- 0
save(doom_df, file = 'doomsday.RData')
table(doom_df$Burnet, doom_df$Doherty)
titledf = doom_df[1:13]
titledf$TextTitle <- 'Title'
names(titledf) <- sub('^Title_', '', names(titledf))
titledf$total <- titledf$positive - titledf$negative
titledf$scotal <- rescale(titledf$total, to = c(0,10))
textdf = doom_df[,c(1:3,14:26)]
textdf$TextTitle <- 'Text'
names(textdf) <- sub('^FT_', '', names(textdf))
textdf$total <- textdf$positive - textdf$negative
textdf$scotal <- rescale(textdf$total, to = c(0,10))
long_doom <- bind_rows(titledf, textdf)
save(long_doom, file='longform doom.csv')
test = long_doom %>% filter(total < 50)
an = lm(scotal ~ TextTitle, data = test)
summary(an)
x = summary(an)
View(x)
ggplot(data=test)+
geom_histogram(aes(x=scotal))
ggplot(data=test)+
geom_histogram(aes(x=scotal), bins = 40)
ggplot(data=test)+
geom_histogram(aes(x=scotal), bins = 50)
ggplot(data=long_doom)+
geom_histogram(aes(x=total), bins = 50)
u = median(long_doom$total)
table(test$scotal)
mean(long_doom$total)
mean(long_doom$scotal)
library(tidyverse)
df = read_csv('Modelling_Sentiment.csv') %>% rename('Index'='...1') %>% distinct(title, .keep_all = T)
mean(df$mean_title_sent)
mean(df$text_sentiment)
df = df %>% filter(!str_detect(publication, 'New Zealand | Timaru'))
rm(list = ls())
df = read_csv('Modelling_Sentiment.csv') %>% rename('Index'='...1') %>% distinct(title, .keep_all = T)
df = df %>% filter(!str_detect(publication, 'New Zealand | Timaru'))
df$pub = df$publication
View(df)
df$pub = gsub('(.*);.*', '\\1', df$publication)
table(df$pub)
df = read_csv('Modelling_Sentiment.csv') %>% rename('Index'='...1') %>% distinct(title, .keep_all = T)
mean(df$mean_title_sent)
mean(df$text_sentiment)
table(df$publication)
## Remove New Zealand newspapers
df = df %>% filter(!str_detect(publication, 'New Zealand | Timaru'))
## Tidy up the publication names
df$pub = gsub('(.*);.*', '\\1', df$publication)
table(df$pub)
est = lm(text_sentiment ~ mean_title_sent, data = df)
summary(est)
ggplot(data = df)+
geom_point(aes(x=text_sentiment, y=mean_title_sent))
View(df)
df2 = df[,c('Index', 'mean_title_sent')]
df2$Sentiment = df2$mean_title_sent
df2$Title_Text = 'Title'
df3 = df[,c('Index', 'text_sentiment')]
df3$Sentiment = df3$text_sentiment
df3$Title_Text = 'Text'
dff = bind_rows(df2, df3)
View(dff)
y = glm(Sentiment ~ Title, data = dff)
y = glm(Sentiment ~ Title_Text, data = dff)
summary(y)
library(tidyverse)
library(xlsx)
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
df <- read_csv("Modelling_Sentiment.csv") %>% rename("Index" = "X1")
View(df)
df <- df %>% dplyr::filter(exclude == 0)
df <- df %>% distinct(title, .keep_all = T)
table(df$publication)
## Remove New Zealand newspapers
nz = c("New Zealand", "Timaru", "Taranaki")
df <- df %>% filter(!str_detect(publication, paste(nz, collapse = "|")))
table(df$publication)
## Remove the trailing place of publication
df$pub <- gsub("(.*);.*", "\\1", df$publication)
table(df$pub)
## Split them into left, right and ABC
x <- data.frame(table(df$pub))
write_csv(x, file = "publications.csv")
owners <- read_csv('publications.csv')
View(owners)
owners <- read_csv('publications.csv')
View(owners)
hope = dplyr:left_join(df, owners, by = 'publication')
hope = dplyr::left_join(df, owners, by = 'publication')
View(hope)
owners <- read_csv('publications.csv')
hope = dplyr::left_join(df, owners, by = 'pub')
View(hope)
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
#######################################################
## Import the Data
df <- read_csv("Modelling_Sentiment.csv") %>% rename("Index" = "X1")
## Drop everything that isn't about modelling
df <- df %>% dplyr::filter(exclude == 0)
df <- df %>% distinct(title, .keep_all = T)
table(df$publication)
## Remove New Zealand newspapers
nz = c("New Zealand", "Timaru", "Taranaki")
df <- df %>% filter(!str_detect(publication, paste(nz, collapse = "|")))
## Tidy up the publication names
# I have manually fixed some of the typos.
# This isn't ideal if I have to download new articles
## Remove the trailing place of publication
df$pub <- gsub("(.*);.*", "\\1", df$publication)
table(df$pub)
owners <- read_csv('publications.csv')
hope = dplyr::left_join(df, owners, by = 'pub')
View(hope)
df = hope
table(df$Burnet, df$Doherty)
df$models = NA
View(df)
df$Doherty = ifelse(df$Doherty == "Doherty", 1, 0)
df$Burnet = ifelse(df$Burnet == "Burnet", 1, 0)
df$BlakelyThompson = if_else(is.na(df$BlakelyThompson), 0, 1)
df$Burnet = if_else(is.na(df$Burnet), 0, 1)
df$Doherty = if_else(is.na(df$Doherty), 0, 1)
df$models[df$Doherty == 1 & df$Burnet == 0 & df$BlakelyThompson == 0] <- 0
df$models[df$Doherty == 1 & df$Burnet == 0 & df$BlakelyThompson == 0] <- 0
df$models[df$Doherty == 0 & df$Burnet == 1 & df$BlakelyThompson == 0] <- 1
df$models[df$Doherty == 0 & df$Burnet == 0 & df$BlakelyThompson == 1] <- 2
df$models[df$Doherty == 1 & df$Burnet == 1 & df$BlakelyThompson == 0] <- 3
df$models[df$Doherty == 1 & df$Burnet == 0 & df$BlakelyThompson == 1] <- 4
df$models[df$Doherty == 0 & df$Burnet == 1 & df$BlakelyThompson == 1] <- 5
df$models[df$Doherty == 1 & df$Burnet == 1 & df$BlakelyThompson == 1] <- 6
table(df$models)
df$catmodels <- factor(df$models)
est = lm(mean_sent ~ mean_title_sent, data = df)
summary(est)
ggplot(data = df)+
geom_point(aes(x=mean_sent, y=mean_title_sent))
fest <- lm(mean_sent ~ mean_title_sent + catmodels, data = df)
summary(fest)
fest <- lm(mean_sent ~ mean_title_sent + owners, data = df)
fest <- lm(mean_sent ~ mean_title_sent + owner, data = df)
fest <- lm(mean_sent ~ mean_title_sent + Owner, data = df)
summary(fest)
est = lm(mean_sent ~ mean_title_sent, data = df)
summary(est)
pest = lm(mean_sent ~ Owner + catmodels + MWPS, data = df)
summary(pest)
## Just Fairfax
ddf = df %>% dplyr::filter(df$Owner == 'Fairfax')
xest = lm(mean_sent ~ catmodels + MWPS, data = ddf)
summary(xest)
df2 = df[,c('Index', 'mean_title_sent', 'MWPS')]
df2$Sentiment = df2$mean_title_sent
df2$Title_Text = 'Title'
df3 = df[,c('Index', 'mean_sent', 'MWPS')]
df3$Sentiment = df3$mean_sent
df3$Title_Text = 'Text'
dff = bind_rows(df2, df3)
y = glm(Sentiment ~ Title_Text, data = dff)
summary(y)
geom_histogram(aes(x="mean_sent"))
ggplot(data = df)+
geom_histogram(aes(x="mean_sent"))
ggplot(data = df)+
geom_histogram(aes(x="mean_sent"), stat = 'count')
mest = lm(mean_sent ~ catmodels + MWPS, data = df)
summary(mest)
rm(list = ls())
View(df)
library(tidyverse)
library(xlsx)
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
df <- read_csv("Modelling_Sentiment.csv") %>% rename("Index" = "X1")
df <- read_csv("Modelling_Sentiment.csv") %>% rename("Index" = "...1")
View(df)
df <- df %>% dplyr::filter(exclude == 0)
df <- df %>% distinct(title, .keep_all = T)
df2 <- read_csv("Modelling_Sentiment.csv") %>% rename("Index" = "...1")
table(df2$publication)
## Remove the trailing place of publication
df$pub <- gsub("(.*);.*", "\\1", df$publication)
table(df$pub)
## Also drop the 'Online'
df$pub <- gsub("(.*)(Online).*", "\\1", df$pub)
table(df$pub)
## Remove the trailing place of publication
df$pub <- gsub("(.*);.*", "\\1", df$publication)
table(df$pub)
## Also drop the 'Online'
df$pub <- gsub("(.*)(Online).*", "\\3", df$pub)
table(df$pub)
x = table(df$pub)
## Remove New Zealand newspapers
nz = c("New Zealand", "Timaru", "Taranaki")
df <- df %>% filter(!str_detect(publication, paste(nz, collapse = "|")))
x = table(df$pub)
## Split them into left, right and ABC
x <- data.frame(table(df$pub))
owners <- read_csv('publications.csv')
hope = dplyr::left_join(df, owners, by = 'pub')
df = hope
View(df)
## Remove the trailing place of publication
df$pub <- gsub("(.*);.*", "\\1", df$publication)
hope = dplyr::left_join(df, owners, by = 'pub')
View(hope)
View(owners)
## Also drop the 'Online'
df$pub <- gsub("(.*)(Online).*", "\\3", df$pub)
x = table(df$pub)
table(df$pub)
## Split them into left, right and ABC
x <- data.frame(table(df$pub))
write_csv(x, file = "publications.csv")
## Remove the trailing place of publication
df$pub <- gsub("(.*);.*", "\\1", df$publication)
table(df$pub)
## Also drop the 'Online'
df$pub <- gsub("(.*)(Online).*", "\\1", df$pub)
table(df$pub)
## Remove the trailing place of publication
df$pub <- gsub("(.*);.*", "\\1", df$publication)
## Also drop the 'Online'
df$pub <- gsub("(.*)(Online).*", "\\2", df$pub)
table(df$pub)
## Remove the trailing place of publication
df$pub <- gsub("(.*);.*", "\\1", df$publication)
table(df$pub)
## Also drop the 'Online'
df$pub <- gsub("(.*)(Online).*", "", df$pub)
table(df$pub)
## Remove the trailing place of publication
df$pub <- gsub("(.*);.*", "\\1", df$publication)
## Also drop the 'Online'
df$pub <- gsub("(.*)(Online)", "", df$pub)
table(df$pub)
## Remove the trailing place of publication
df$pub <- gsub("(.*);.*", "\\1", df$publication)
table(df$pub)
## Also drop the 'Online'
df$pub <- gsub("(Online)", "", df$pub)
table(df$pub)
## Remove the trailing place of publication
df$pub <- gsub("(.*);.*", "\\1", df$publication)
## Also drop the 'Online'
df$pub <- gsub("( (Online))", "", df$pub)
table(df$pub)
## Also drop the 'Online'
df$pub <- gsub("(\(Online\))", "", df$pub)
## Also drop the 'Online'
df$pub <- gsub("(\\(Online\\))", "", df$pub)
table(df$pub)
## Remove the trailing place of publication
df$pub <- gsub("(.*);.*", "\\1", df$publication)
## Also drop the 'Online'
df$pub <- gsub("( \\(Online\\))", "", df$pub)
table(df$pub)
x = table(df$pub)
## Split them into left, right and ABC
x <- data.frame(table(df$pub))
write_csv(x, file = "publications.csv")
write_csv(x, file = "publications.csv")
owners <- read_csv('publications.csv')
View(owners)
owners <- read_csv('publications.csv')
View(owners)
hope = dplyr::left_join(df, owners, by = 'pub')
View(hope)
hope$Owner <- NULL
df = hope
View(df)
table(df$pub)
x = table(df$pub)
table(df$owner)
## Number of mastheads per outlet
nc <- df %>% dplyr::filter(owner == Murdoch)
## Number of mastheads per outlet
nc <- df %>% dplyr::filter(owner == "Murdoch")
n <- table(nc$pub)
acm <- df %>% dplyr::filter(owner == "ACM")
a <- table(acm$pub)
ffx <- df %>% dplyr::filter(owner == "Fairfax")
f <- table(ffx$pub)
####################################################################################
save(df, file = "doomsday.RData")
